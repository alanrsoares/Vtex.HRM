<section id="analysisDetail" ng-controller="AnalysisDetailCtrl">

    <div ng-show="analysisHistory" id="analysisHistory">

        <div class="page-header">
            <h1>Histórico de Análises</h1>
        </div>

        <table class="table table-hover table-striped">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Primeiro Teste</th>
                    <th>Teste de Confirmação</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="analysis in analysisHistory">
                    <td>{{analysis.id}}</td>
                    <td>{{analysis.timefirsttest | unixDate}} </td>
                    <td>{{analysis.timeconfirmtest | unixDate}} </td>
                    <td>
                        <a href="#/resources/analysis/{{checkId}}/?analysisId={{analysis.id}}">detalhe <i class="icon-share-alt"></i>
                        </a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div id="analysisDetailContainer" ng-show="analysisDetail">

        <div class="page-header">
            <h1>Análise - Detalhe
                <small>
                    <a href="#/resources/analysis/{{check.id}}" target="_blank">ver hist&oacute;rico</a>
                </small>
            </h1>
        </div>

        <div class="well">
            <ul>
                <li><strong>Status</strong>: 
                    <pre style="background: white">{{analysisDetail.firststatusdesc}} - {{analysisDetail.firststatusdesclong}}</pre>
                </li>
                <li><strong>Status de Confirmação</strong>: 
                    <pre style="background: white">{{analysisDetail.confirmstatusdesc}} - {{analysisDetail.confirmstatusdesclong}}</pre>
                </li>
                <li><strong>Tipo</strong>: 
                    <pre style="background: white">{{analysisDetail.analysisresult.analysis_type}}</pre>
                </li>
                <li><strong>Disparado em</strong>: 
                    <pre style="background: white">{{analysisDetail.analysisresult.time_triggered | unixDate}}</pre>
                </li>
                <li>
                    <strong>Tasks</strong>:
                    <div class="well" style="background: white">
                        <ul class="nav nav-tabs" id="checkTabsList">

                            <li ng-repeat="task in analysisDetail.analysisresult.tasks" ng-class="{active:task==analysisDetail.analysisresult.tasks[0]}">
                                <a showtab href="#task-{{task.analyzer_id}}">{{task.analyzer_id}}</a>
                            </li>

                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane" ng-repeat="task in analysisDetail.analysisresult.tasks" id="task-{{task.analyzer_id}}" ng-class="{active:task==analysisDetail.analysisresult.tasks[0]}">
                                <p>
                                    <strong>Início</strong>:
                                    <pre>{{task.time_start | unixDate}}</pre>

                                    <strong>Fim</strong>:
                                    <pre>{{task.time_end | unixDate}}</pre>

                                    <strong>Status</strong>:
                                    <pre>{{task.status}}</pre>

                                    <strong>Mensagem</strong>:
                                    <pre>{{(task.result | filter:{name:'message'})[0].value}}</pre>

                                    <strong>Retorno do request</strong>:
                                    <pre>{{jsonOutp}}</pre>

                                </p>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
        </div>

    </div>

</section>
